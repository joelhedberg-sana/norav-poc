@page "/nurse"
@inject HttpClient Http
@inject IConfiguration Cfg

<h3>ECG Demographics → Worklist (INI)</h3>

<EditForm Model="@m" OnValidSubmit="Submit">
  <DataAnnotationsValidator />
  <ValidationSummary />
  <InputText @bind-Value="m.PatientId" placeholder="Patient ID" />
  <InputText @bind-Value="m.PatientName" placeholder="Patient Name" />
  <InputText @bind-Value="m.AccessionNumber" placeholder="Accession" />
  <button type="submit">Write Worklist</button>
</EditForm>

<p>@status</p>

@code {
  Demographics m = new();
  string status = "";

  public class Demographics
  {
    public string PatientId { get; set; } = string.Empty;
    public string PatientName { get; set; } = string.Empty;
    public string? AccessionNumber { get; set; }
  }

  private async Task Submit()
  {
    var agent = Cfg["AgentUrl"]!;
    var resp = await Http.PostAsJsonAsync($"{agent}/demographics", m);
    status = resp.IsSuccessStatusCode ? "INI written. Open ECG app → Worklist." : "Failed.";
  }
}
